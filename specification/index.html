
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="The AFM specification defines a structured, markdown-based format for AI agents, enabling easy sharing, deployment, and understanding across platforms.">
      
      
        <meta name="author" content="WSO2 LLC">
      
      
        <link rel="canonical" href="https://wso2.github.io/agent-flavored-markdown/specification/">
      
      
        <link rel="prev" href="..">
      
      
        <link rel="next" href="../examples/">
      
      
        
      
      
      <link rel="icon" href="../assets/afm_logo.svg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.3">
    
    
      
        <title>Specification - Agent-Flavored Markdown</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
  
      
    
  <!-- highlight.js for AFM syntax highlighting (with SRI) -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/styles/default.min.css" integrity="sha384-4Y0nObtF3CbKnh+lpzmAVdAMtQXl+ganWiiv73RcGVdRdfVIya8Cao1C8ZsVRRDz" crossorigin="anonymous">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js" integrity="sha384-RH2xi4eIQ/gjtbs9fUXM68sLSi99C7ZWBRX1vDrVv6GQXRibxXLbwO2NGZB74MbU" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/yaml.min.js" integrity="sha384-A/iMReLA0Bo3tLydBIoOQXQzYnrwL90jkHYUubrtERUGCbIuU7U0EHge0Xd2s5sr" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/markdown.min.js" integrity="sha384-Rv26WbhHH4MDPzeExq4ECmZUYF942tlfVhqA91Drw1P+Ey55KjihLF9RJENxjWr1" crossorigin="anonymous"></script>

    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="grey">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#afm-specification-v030" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <!--
  ~ Copyright (c) 2025, WSO2 LLC (http://www.wso2.com) All Rights Reserved.
  ~
  ~ WSO2 LLC licenses this file to you under the Apache License,
  ~ Version 2.0 (the "License"); you may not use this file except
  ~ in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing,
  ~ software distributed under the License is distributed on an
  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  ~ KIND, either express or implied. See the License for the
  ~ specific language governing permissions and limitations
  ~ under the License.
  -->

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="https://wso2.github.io/agent-flavored-markdown/" title="Agent-Flavored Markdown" class="md-header__button md-logo" aria-label="Agent-Flavored Markdown" data-md-component="logo">
      
  <img src="../assets/afm_logo.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Agent-Flavored Markdown
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Specification
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="grey"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
              </label>
            
          
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="grey"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/wso2/agent-flavored-markdown" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    wso2/agent-flavored-markdown
  </div>
</a>
      </div>
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  Specification

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../examples/" class="md-tabs__link">
          
  
  
    
  
  Examples

        </a>
      </li>
    
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../reference-implementations/" class="md-tabs__link">
        
  
  
    
  
  Reference Implementations

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
                
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" hidden>
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Agent-Flavored Markdown" class="md-nav__button md-logo" aria-label="Agent-Flavored Markdown" data-md-component="logo">
      
  <img src="../assets/afm_logo.svg" alt="logo">

    </a>
    Agent-Flavored Markdown
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/wso2/agent-flavored-markdown" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    wso2/agent-flavored-markdown
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Home
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Specification
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Specification
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Introduction
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-key-goals-of-afm" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1. Key Goals of AFM
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Core Concepts
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-file-extension" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. File Extension
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-syntax-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Syntax Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Syntax Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-basic-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1. Basic Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-front-matter" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2. Front Matter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-markdown-body" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3. Markdown Body
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.4. Example
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-schema-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Schema Definitions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Schema Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-agent-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1. Agent Details
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.1. Agent Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#511-schema-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1.1. Schema Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agent-field-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1.2. Field Definitions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#513-example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1.3. Example Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-agent-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2. Agent Model
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.2. Agent Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#521-field-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2.1. Field Definitions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#522-schema-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2.2. Schema Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#523-example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2.3. Example Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-agent-interfaces" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3. Agent Interfaces
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.3. Agent Interfaces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#531-interface-types" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.1. Interface Types
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#532-schema-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.2. Schema Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#533-field-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.3. Field Definitions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.3.3. Field Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#signature-object" class="md-nav__link">
    <span class="md-ellipsis">
      
        Signature Object
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exposure-object" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exposure Object
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#534-example-usages" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.4. Example Usages
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4. Tools
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.4. Tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#541-schema-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4.1. Schema Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#542-field-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4.2. Field Definitions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#543-example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4.3. Example Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#55-agent-execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5. Agent Execution
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.5. Agent Execution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#551-schema-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5.1. Schema Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#552-field-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5.2. Field Definitions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#553-example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5.3. Example Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#56-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.6. Authentication
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.6. Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#561-schema-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.6.1. Schema Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#562-field-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.6.2. Field Definitions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#563-example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.6.3. Example Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-protocol-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Protocol Specifications
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Protocol Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-model-context-protocol-mcp" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1. Model Context Protocol (MCP)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.1. Model Context Protocol (MCP)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#611-schema-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1.1. Schema Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#612-field-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1.2. Field Definitions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#613-example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1.3. Example Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-variable-substitution" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Variable Substitution
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Variable Substitution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-variable-prefixes" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.1. Variable Prefixes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.2. Example Usage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-webhook-variable-access-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.3. Webhook Variable Access Patterns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-future-work" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Future Work
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <div class="md-nav__link md-nav__container">
            <a href="../examples/" class="md-nav__link ">
              
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/friendly_assistant/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Friendly Assistant
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/math_tutor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Math Tutor
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/pull_request_analyzer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    GitHub Pull Request Analyzer
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../reference-implementations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Reference Implementations
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
                
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      
        1. Introduction
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="1. Introduction">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#11-key-goals-of-afm" class="md-nav__link">
    <span class="md-ellipsis">
      
        1.1. Key Goals of AFM
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      
        2. Core Concepts
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-file-extension" class="md-nav__link">
    <span class="md-ellipsis">
      
        3. File Extension
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-syntax-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        4. Syntax Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Syntax Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-basic-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.1. Basic Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-front-matter" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.2. Front Matter
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-markdown-body" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.3. Markdown Body
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-example" class="md-nav__link">
    <span class="md-ellipsis">
      
        4.4. Example
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-schema-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        5. Schema Definitions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Schema Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-agent-details" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1. Agent Details
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.1. Agent Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#511-schema-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1.1. Schema Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#agent-field-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1.2. Field Definitions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#513-example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.1.3. Example Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-agent-model" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2. Agent Model
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.2. Agent Model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#521-field-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2.1. Field Definitions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#522-schema-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2.2. Schema Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#523-example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.2.3. Example Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-agent-interfaces" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3. Agent Interfaces
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.3. Agent Interfaces">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#531-interface-types" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.1. Interface Types
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#532-schema-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.2. Schema Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#533-field-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.3. Field Definitions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.3.3. Field Definitions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#signature-object" class="md-nav__link">
    <span class="md-ellipsis">
      
        Signature Object
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exposure-object" class="md-nav__link">
    <span class="md-ellipsis">
      
        Exposure Object
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#534-example-usages" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.3.4. Example Usages
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4. Tools
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.4. Tools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#541-schema-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4.1. Schema Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#542-field-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4.2. Field Definitions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#543-example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.4.3. Example Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#55-agent-execution" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5. Agent Execution
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.5. Agent Execution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#551-schema-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5.1. Schema Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#552-field-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5.2. Field Definitions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#553-example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.5.3. Example Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#56-authentication" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.6. Authentication
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5.6. Authentication">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#561-schema-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.6.1. Schema Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#562-field-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.6.2. Field Definitions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#563-example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        5.6.3. Example Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-protocol-specifications" class="md-nav__link">
    <span class="md-ellipsis">
      
        6. Protocol Specifications
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6. Protocol Specifications">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#61-model-context-protocol-mcp" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1. Model Context Protocol (MCP)
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="6.1. Model Context Protocol (MCP)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#611-schema-overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1.1. Schema Overview
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#612-field-definitions" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1.2. Field Definitions
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#613-example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        6.1.3. Example Usage
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#7-variable-substitution" class="md-nav__link">
    <span class="md-ellipsis">
      
        7. Variable Substitution
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="7. Variable Substitution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#71-variable-prefixes" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.1. Variable Prefixes
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-example-usage" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.2. Example Usage
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-webhook-variable-access-patterns" class="md-nav__link">
    <span class="md-ellipsis">
      
        7.3. Webhook Variable Access Patterns
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#8-future-work" class="md-nav__link">
    <span class="md-ellipsis">
      
        8. Future Work
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  
  



  
  


<h1 id="afm-specification-v030">AFM Specification v0.3.0<a class="headerlink" href="#afm-specification-v030" title="Permanent link">&para;</a></h1>
<h2 id="1-introduction">1. Introduction<a class="headerlink" href="#1-introduction" title="Permanent link">&para;</a></h2>
<p>AFM (Agent-Flavored Markdown) is a markdown-based format to define AI agents. It allows agents to be written in text once and reused across different platforms.</p>
<p>This document details the AFM file format, its syntax, and the schema for defining an agent.</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="https://www.rfc-editor.org/info/bcp14">BCP 14</a> [<a href="https://datatracker.ietf.org/doc/html/rfc2119">RFC2119</a>] [<a href="https://datatracker.ietf.org/doc/html/rfc8174">RFC8174</a>] when, and only when, they appear in all capitals, as shown here.</p>
<h3 id="11-key-goals-of-afm">1.1. Key Goals of AFM<a class="headerlink" href="#11-key-goals-of-afm" title="Permanent link">&para;</a></h3>
<p>AFM unifies agent definition through a text-based standard:</p>
<ul>
<li>
<p><strong>No Code</strong>: AFM enables defining an agent's instructions, tools, and configuration in a simple, declarative, text-based format, moving away from complex, imperative code. The markdown-based syntax is intuitive for both developers and non-technical stakeholders to read, write, and understand.</p>
</li>
<li>
<p><strong>Portable</strong>: By defining agents declaratively in text rather than code, AFM enables the same agent definition to be interpreted and deployed across diverse platforms and tools.</p>
</li>
<li>
<p><strong>Unified</strong>: AFM provides a clean, declarative model that works seamlessly for both developers writing code and those using visual, low-code interfaces. The same AFM file can power both experiences.</p>
</li>
<li>
<p><strong>Adaptable</strong>: AFM is designed to be flexible and extensible, allowing the standard to evolve as AI technologies and requirements change.</p>
</li>
</ul>
<h2 id="2-core-concepts">2. Core Concepts<a class="headerlink" href="#2-core-concepts" title="Permanent link">&para;</a></h2>
<p>AFM defines the following core concepts:</p>
<ul>
<li><strong>Agent</strong>: The primary entity defined by an AFM file, representing an AI agent.</li>
<li><strong>Role</strong>: The agent's purpose and responsibilities.</li>
<li><strong>Instructions</strong>: Directives governing the agent's behavior.</li>
<li><strong>Details</strong>: Metadata describing the agent (name, version, author, etc.).</li>
<li><strong>Model</strong>: The AI model powering the agent.</li>
<li><strong>Tools</strong>: External tools and services available to the agent.</li>
<li><strong>Interface</strong>: How the agent is invoked and its input/output contract.</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Agent Memory</p>
<p>Given the lack of standardization, AFM does not prescribe a standard for agent memory yet.</p>
</div>
<h2 id="3-file-extension">3. File Extension<a class="headerlink" href="#3-file-extension" title="Permanent link">&para;</a></h2>
<p>An agent definition file MUST use the <code>.afm.md</code> or <code>.afm</code> extension. </p>
<h2 id="4-syntax-overview">4. Syntax Overview<a class="headerlink" href="#4-syntax-overview" title="Permanent link">&para;</a></h2>
<h3 id="41-basic-structure">4.1. Basic Structure<a class="headerlink" href="#41-basic-structure" title="Permanent link">&para;</a></h3>
<p>An AFM file is structured into two main sections: the front matter and the agent declaration.</p>
<ul>
<li><strong>Front Matter</strong>: Contains metadata about the agent.</li>
<li><strong>Markdown Body</strong>: Contains the agent's definition.</li>
</ul>
<h3 id="42-front-matter">4.2. Front Matter<a class="headerlink" href="#42-front-matter" title="Permanent link">&para;</a></h3>
<p>The front matter is a YAML block at the top of the file, enclosed by <code>---</code> lines. Refer to the <a href="https://yaml.org/spec/1.2/spec.html">YAML specification</a> for more details on YAML syntax.</p>
<p>This section contains metadata about the agent. These metadata fields are <strong>OPTIONAL</strong> and can be used to provide additional context or configuration for the agent.</p>
<table>
<thead>
<tr>
<th>Section</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="#51-agent-details">Agent Details</a></td>
<td>Information about the agent, such as its name, description, version, and author.</td>
</tr>
<tr>
<td><a href="#52-agent-model">Agent Model</a></td>
<td>Defines the AI model that powers the agent.</td>
</tr>
<tr>
<td><a href="#53-agent-interfaces">Agent Interfaces</a></td>
<td>Defines how the agent is invoked and its input/output signature.</td>
</tr>
<tr>
<td><a href="#54-tools">Agent Tools</a></td>
<td>Defines external tools available to the agent (e.g., via MCP).</td>
</tr>
<tr>
<td><a href="#55-agent-execution">Agent Execution</a></td>
<td>Runtime execution configuration like iteration limits.</td>
</tr>
</tbody>
</table>
<p>Refer to the <a href="#5-schema-definitions">AFM Schema</a> for a complete list of fields and their meanings.</p>
<h3 id="43-markdown-body">4.3. Markdown Body<a class="headerlink" href="#43-markdown-body" title="Permanent link">&para;</a></h3>
<p>This section contains the detailed instructions that guide the agent's behavior.</p>
<p>Users can use markdown syntax to format the text, including headings, lists, links, and code blocks.</p>
<p>The Markdown body <strong>MUST</strong> contain the following headings, with corresponding content.</p>
<ul>
<li><code># Role</code>: Defines the agent's purpose and responsibilities. This section describes what the agent does and the context in which it operates. This content typically forms the opening context of the system prompt.</li>
<li><code># Instructions</code>: Provides directives that shape the agent's behavior, capabilities, and operational guidelines. This section contains the core logic and rules that govern how the agent processes inputs and generates outputs.</li>
</ul>
<h3 id="44-example">4.4. Example<a class="headerlink" href="#44-example" title="Permanent link">&para;</a></h3>
<div class="admonition example">
<p class="admonition-title">Basic AFM File Example</p>
<p>Here is a simple example of an AFM file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nn">---</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="nt">spec_version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0.3.0&quot;</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Math</span><span class="nv"> </span><span class="s">Tutor&quot;</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;An</span><span class="nv"> </span><span class="s">AI</span><span class="nv"> </span><span class="s">assistant</span><span class="nv"> </span><span class="s">that</span><span class="nv"> </span><span class="s">helps</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">math</span><span class="nv"> </span><span class="s">problems&quot;</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.0.0&quot;</span>
<a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a><span class="nt">max_iterations</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20</span>
<a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="nt">interfaces</span><span class="p">:</span>
<a id="__codelineno-0-8" name="__codelineno-0-8" href="#__codelineno-0-8"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">consolechat</span>
<a id="__codelineno-0-9" name="__codelineno-0-9" href="#__codelineno-0-9"></a><span class="nt">model</span><span class="p">:</span>
<a id="__codelineno-0-10" name="__codelineno-0-10" href="#__codelineno-0-10"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;gpt-4o&quot;</span>
<a id="__codelineno-0-11" name="__codelineno-0-11" href="#__codelineno-0-11"></a><span class="w">  </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;openai&quot;</span>
<a id="__codelineno-0-12" name="__codelineno-0-12" href="#__codelineno-0-12"></a><span class="w">  </span><span class="nt">authentication</span><span class="p">:</span>
<a id="__codelineno-0-13" name="__codelineno-0-13" href="#__codelineno-0-13"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;api-key&quot;</span>
<a id="__codelineno-0-14" name="__codelineno-0-14" href="#__codelineno-0-14"></a><span class="w">    </span><span class="nt">api_key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${env:OPENAI_API_KEY}&quot;</span>
<a id="__codelineno-0-15" name="__codelineno-0-15" href="#__codelineno-0-15"></a><span class="nt">tools</span><span class="p">:</span>
<a id="__codelineno-0-16" name="__codelineno-0-16" href="#__codelineno-0-16"></a><span class="w">  </span><span class="nt">mcp</span><span class="p">:</span>
<a id="__codelineno-0-17" name="__codelineno-0-17" href="#__codelineno-0-17"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;math_operations&quot;</span>
<a id="__codelineno-0-18" name="__codelineno-0-18" href="#__codelineno-0-18"></a><span class="w">      </span><span class="nt">transport</span><span class="p">:</span>
<a id="__codelineno-0-19" name="__codelineno-0-19" href="#__codelineno-0-19"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http&quot;</span>
<a id="__codelineno-0-20" name="__codelineno-0-20" href="#__codelineno-0-20"></a><span class="w">        </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${env:MATH_MCP_SERVER}&quot;</span>
<a id="__codelineno-0-21" name="__codelineno-0-21" href="#__codelineno-0-21"></a><span class="nn">---</span>
<a id="__codelineno-0-22" name="__codelineno-0-22" href="#__codelineno-0-22"></a>
<a id="__codelineno-0-23" name="__codelineno-0-23" href="#__codelineno-0-23"></a><span class="c1"># Role</span>
<a id="__codelineno-0-24" name="__codelineno-0-24" href="#__codelineno-0-24"></a>
<a id="__codelineno-0-25" name="__codelineno-0-25" href="#__codelineno-0-25"></a><span class="l l-Scalar l-Scalar-Plain">You are an experienced math tutor capable of assisting students with mathematics problems, providing explanations, step-by-step</span><span class="w"> </span>
<a id="__codelineno-0-26" name="__codelineno-0-26" href="#__codelineno-0-26"></a><span class="l l-Scalar l-Scalar-Plain">solutions, and practice exercises.</span>
<a id="__codelineno-0-27" name="__codelineno-0-27" href="#__codelineno-0-27"></a>
<a id="__codelineno-0-28" name="__codelineno-0-28" href="#__codelineno-0-28"></a><span class="l l-Scalar l-Scalar-Plain"># Instructions</span>
<a id="__codelineno-0-29" name="__codelineno-0-29" href="#__codelineno-0-29"></a>
<a id="__codelineno-0-30" name="__codelineno-0-30" href="#__codelineno-0-30"></a><span class="l l-Scalar l-Scalar-Plain">You are a knowledgeable and patient math tutor who helps students understand mathematical concepts. Provide clear, step-by-step</span><span class="w"> </span>
<a id="__codelineno-0-31" name="__codelineno-0-31" href="#__codelineno-0-31"></a><span class="l l-Scalar l-Scalar-Plain">explanations for math problems, using simple language and avoiding jargon unless explaining it.</span><span class="w"> </span>
<a id="__codelineno-0-32" name="__codelineno-0-32" href="#__codelineno-0-32"></a>
<a id="__codelineno-0-33" name="__codelineno-0-33" href="#__codelineno-0-33"></a><span class="l l-Scalar l-Scalar-Plain">When solving problems, show all work and explain each step. Use the available math operations tools when performing calculations.</span><span class="w"> </span>
<a id="__codelineno-0-34" name="__codelineno-0-34" href="#__codelineno-0-34"></a><span class="l l-Scalar l-Scalar-Plain">Explain mathematical concepts with real-world examples when possible. Be encouraging and supportive of students&#39; efforts, ask clarifying</span><span class="w"> </span>
<a id="__codelineno-0-35" name="__codelineno-0-35" href="#__codelineno-0-35"></a><span class="l l-Scalar l-Scalar-Plain">questions if a problem is not clearly stated, provide multiple approaches to solving problems when applicable, help students identify</span><span class="w"> </span>
<a id="__codelineno-0-36" name="__codelineno-0-36" href="#__codelineno-0-36"></a><span class="l l-Scalar l-Scalar-Plain">and correct their mistakes.</span>
</code></pre></div>
</div>
<h2 id="5-schema-definitions">5. Schema Definitions<a class="headerlink" href="#5-schema-definitions" title="Permanent link">&para;</a></h2>
<p>This section defines the schema for the Front Matter. For clarity, the schema is divided into several subsections, each detailing a specific aspect of the Agent.</p>
<h3 id="51-agent-details">5.1. Agent Details<a class="headerlink" href="#51-agent-details" title="Permanent link">&para;</a></h3>
<p>This section defines the schema for agent-specific metadata. It is <strong>OPTIONAL</strong> but recommended for clarity and organization.</p>
<p>AFM implementations <strong>SHALL</strong> use this section to display the agent's metadata in user interfaces to provide better user experience for end users.</p>
<h4 id="511-schema-overview">5.1.1. Schema Overview<a class="headerlink" href="#511-schema-overview" title="Permanent link">&para;</a></h4>
<p>The agent metadata fields are specified in the YAML front matter of an AFM file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nt">spec_version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">   </span><span class="c1"># AFM specification version (e.g., &quot;0.3.0&quot;)</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">           </span><span class="c1"># The name of the agent</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">    </span><span class="c1"># Brief description of the agent&#39;s purpose and functionality</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">        </span><span class="c1"># Semantic version (e.g., &quot;1.0.0&quot;)</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="nt">author</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">         </span><span class="c1"># Single author in format &quot;Name &lt;Email&gt;&quot;</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="nt">authors</span><span class="p">:</span><span class="w">               </span><span class="c1"># Takes precedence over the &#39;author&#39; field if both exist</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">             </span><span class="c1"># Multiple authors, each in format &quot;Name &lt;Email&gt;&quot;</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span><span class="w">       </span><span class="c1"># Agent provider</span>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">         </span><span class="c1"># Name of the organization</span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="w">  </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">          </span><span class="c1"># URL to the organization&#39;s website</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="nt">icon_url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">       </span><span class="c1"># URL to an icon representing the agent</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="nt">license</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">        </span><span class="c1"># License under which the agent is released</span>
</code></pre></div>
<h4 id="agent-field-definitions">5.1.2. Field Definitions<a class="headerlink" href="#agent-field-definitions" title="Permanent link">&para;</a></h4>
<p>Each field serves a specific purpose in defining and organizing the agent:</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>spec_version</code></td>
<td><code>string</code></td>
<td>No</td>
<td>Version of the AFM specification this file conforms to (e.g., "0.3.0").<br>This is <strong>OPTIONAL</strong> but recommended for compatibility.<br>AFM implementations <strong>MAY</strong> use this field to validate compatibility and provide warnings for mismatched spec versions.</td>
</tr>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>No</td>
<td>Identifies the agent in human-readable form.<br>Default: inferred from the filename of the AFM file.<br>AFM implementations <strong>SHALL</strong> use this field to display the agent's name in user interfaces.</td>
</tr>
<tr>
<td><code>description</code></td>
<td><code>string</code></td>
<td>No</td>
<td>Provides a concise summary of what the agent does.<br>Default: inferred from the markdown body <code># Role</code> section.<br>AFM implementations <strong>SHALL</strong> use this field to display the agent's description in user interfaces.</td>
</tr>
<tr>
<td><code>version</code></td>
<td><code>string</code></td>
<td>No</td>
<td><a href="https://semver.org/">Semantic version</a> of the agent definition (MAJOR.MINOR.PATCH).<br>Default: "0.0.0".<br>AFM implementations <strong>SHALL</strong> use this field to display the agent's version in user interfaces.</td>
</tr>
<tr>
<td><code>author</code></td>
<td><code>string</code></td>
<td>No</td>
<td>Single author in format <code>Name &lt;Email&gt;</code>.<br>Credits the creator of the agent definition. If both <code>author</code> and <code>authors</code> fields are provided, <code>authors</code> takes precedence.</td>
</tr>
<tr>
<td><code>authors</code></td>
<td><code>string[]</code></td>
<td>No</td>
<td>Multiple authors, each in format <code>Name &lt;Email&gt;</code>.<br>Credits the creators of the agent definition. Takes precedence over <code>author</code> if both exist.</td>
</tr>
<tr>
<td><code>icon_url</code></td>
<td><code>string</code></td>
<td>No</td>
<td>URL to an icon representing the agent.<br>This is <strong>OPTIONAL</strong> but recommended for visual representation in user interfaces.<br>AFM implementations <strong>SHALL</strong> use this field to display the agent's icon in user interfaces.</td>
</tr>
<tr>
<td><code>provider</code></td>
<td><code>object</code></td>
<td>No</td>
<td>Information about the organization providing the agent.<br>This is <strong>OPTIONAL</strong> but recommended for attribution.<br>See the Provider Object below for details.</td>
</tr>
<tr>
<td><code>license</code></td>
<td><code>string</code></td>
<td>No</td>
<td>License under which the agent definition is released.<br>This is <strong>OPTIONAL</strong> but recommended for clarity.</td>
</tr>
</tbody>
</table>
<p><strong><a id="provider-object"></a>Provider Object:</strong></p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>No</td>
<td>Name of the organization providing the agent.</td>
</tr>
<tr>
<td><code>url</code></td>
<td><code>string</code></td>
<td>No</td>
<td>URL to the organization's website.</td>
</tr>
</tbody>
</table>
<h4 id="513-example-usage">5.1.3. Example Usage<a class="headerlink" href="#513-example-usage" title="Permanent link">&para;</a></h4>
<p>The following example demonstrates a valid agent metadata section as specified in <a href="#51-agent-details">Section 5.1</a>. This YAML front matter illustrates the use of recommended and optional fields for agent definition:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nn">---</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="nt">spec_version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0.3.0&quot;</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Math</span><span class="nv"> </span><span class="s">Tutor&quot;</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;An</span><span class="nv"> </span><span class="s">AI</span><span class="nv"> </span><span class="s">assistant</span><span class="nv"> </span><span class="s">that</span><span class="nv"> </span><span class="s">helps</span><span class="nv"> </span><span class="s">with</span><span class="nv"> </span><span class="s">math</span><span class="nv"> </span><span class="s">problems&quot;</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="nt">version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.0&quot;</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="nt">authors</span><span class="p">:</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;Jane</span><span class="nv"> </span><span class="s">Smith</span><span class="nv"> </span><span class="s">&lt;jane@example.com&gt;&quot;</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;John</span><span class="nv"> </span><span class="s">Doe</span><span class="nv"> </span><span class="s">&lt;john@example.com&gt;&quot;</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="nt">provider</span><span class="p">:</span>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example</span><span class="nv"> </span><span class="s">AI</span><span class="nv"> </span><span class="s">Solutions&quot;</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="w">  </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com&quot;</span>
<a id="__codelineno-2-12" name="__codelineno-2-12" href="#__codelineno-2-12"></a><span class="nt">icon_url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/icons/math-tutor.png&quot;</span>
<a id="__codelineno-2-13" name="__codelineno-2-13" href="#__codelineno-2-13"></a><span class="nt">license</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;MIT&quot;</span>
<a id="__codelineno-2-14" name="__codelineno-2-14" href="#__codelineno-2-14"></a><span class="nn">---</span>
</code></pre></div>
<h3 id="52-agent-model">5.2. Agent Model<a class="headerlink" href="#52-agent-model" title="Permanent link">&para;</a></h3>
<p>This section specifies the AI model or language model that powers the agent. It is <strong>OPTIONAL</strong> and defines how to access and authenticate with the model service.</p>
<h4 id="521-field-definitions">5.2.1. Field Definitions<a class="headerlink" href="#521-field-definitions" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>No</td>
<td>Model identifier or name.</td>
</tr>
<tr>
<td><code>provider</code></td>
<td><code>string</code></td>
<td>No</td>
<td>The organization or service providing the model (e.g., "openai", "anthropic").</td>
</tr>
<tr>
<td><code>url</code></td>
<td><code>string</code></td>
<td>No</td>
<td>The URL endpoint for the model service.</td>
</tr>
<tr>
<td><code>authentication</code></td>
<td><code>object</code></td>
<td>No</td>
<td>Authentication configuration for accessing the model. See <a href="#56-authentication">Section 5.6</a> for the schema.</td>
</tr>
</tbody>
</table>
<h4 id="522-schema-overview">5.2.2. Schema Overview<a class="headerlink" href="#522-schema-overview" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nt">model</span><span class="p">:</span>
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">             </span><span class="c1"># Optional model name or identifier</span>
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">  </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">         </span><span class="c1"># Optional model provider (e.g., &quot;openai&quot;, &quot;anthropic&quot;)</span>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">  </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">              </span><span class="c1"># Optional model service endpoint URL</span>
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">  </span><span class="nt">authentication</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span><span class="w">   </span><span class="c1"># Optional authentication configuration</span>
</code></pre></div>
<h4 id="523-example-usage">5.2.3. Example Usage<a class="headerlink" href="#523-example-usage" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="nt">model</span><span class="p">:</span>
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;gpt-4o&quot;</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">  </span><span class="nt">provider</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;openai&quot;</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">  </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://api.openai.com/v1/chat/completions&quot;</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">  </span><span class="nt">authentication</span><span class="p">:</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;api-key&quot;</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="w">    </span><span class="nt">api_key</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${env:OPENAI_API_KEY}&quot;</span>
</code></pre></div>
<h3 id="53-agent-interfaces">5.3. Agent Interfaces<a class="headerlink" href="#53-agent-interfaces" title="Permanent link">&para;</a></h3>
<p>This section defines how an agent can be interacted with or triggered. An agent can have multiple interfaces, allowing it to be accessed in different ways. It is <strong>OPTIONAL</strong> and specifies how the agent receives inputs and produces outputs.</p>
<p>If the <code>interfaces</code> field is not explicitly defined in the front matter, AFM implementations <strong>MUST</strong> assume a default interface of type <code>consolechat</code>. In this default mode, the agent <strong>SHALL</strong> be invoked as a command-line chat interface: it <strong>MUST</strong> accept a single string input (user message) and <strong>MUST</strong> produce a single string output (agent reply).</p>
<p>Users can override these defaults by specifying the <code>interfaces</code> field in the front matter as an array of interface definitions. AFM implementations <strong>SHALL</strong> use these definitions to generate the agent's callable interfaces and to ensure consistent behavior across different platforms.</p>
<h4 id="531-interface-types">5.3.1. Interface Types<a class="headerlink" href="#531-interface-types" title="Permanent link">&para;</a></h4>
<p>The <code>interface.type</code> field <strong>MUST</strong> be one of the following values:</p>
<table>
<thead>
<tr>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>consolechat</code></td>
<td>The agent is exposed as a command-line/terminal chat interface for interactive console-based conversations.</td>
</tr>
<tr>
<td><code>webchat</code></td>
<td>The agent is exposed as a web-based chat interface, accessible through browsers with a conversational UI.</td>
</tr>
<tr>
<td><code>webhook</code></td>
<td>The agent is exposed as a webhook endpoint and supports subscription details (e.g., WebSub hub integration).</td>
</tr>
</tbody>
</table>
<p>Each interface type defines how the agent is triggered and interacted with. Implementations <strong>MAY</strong> support all three types as described above.</p>
<h4 id="532-schema-overview">5.3.2. Schema Overview<a class="headerlink" href="#532-schema-overview" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="nt">interfaces</span><span class="p">:</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">consolechat | webchat | webhook</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a><span class="w">    </span><span class="nt">prompt</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">              </span><span class="c1"># For webhook type: template string for constructing the user prompt for the agent run</span>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="w">    </span><span class="nt">signature</span><span class="p">:</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a><span class="w">      </span><span class="nt">input</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span><span class="w">             </span><span class="c1"># JSON Schema object defining input parameters</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a><span class="w">      </span><span class="nt">output</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span><span class="w">            </span><span class="c1"># JSON Schema object defining output parameters</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a><span class="w">    </span><span class="c1"># Optional, depending on type:</span>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="w">    </span><span class="nt">exposure</span><span class="p">:</span><span class="w">                   </span><span class="c1"># For webchat/webhook types only</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="w">      </span><span class="nt">http</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span><span class="w">              </span><span class="c1"># Configuration for exposing as an HTTP endpoint.</span>
<a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a><span class="w">    </span><span class="nt">subscription</span><span class="p">:</span><span class="w">               </span><span class="c1"># For webhook type</span>
<a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a><span class="w">      </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">          </span><span class="c1"># e.g., &quot;websub&quot;</span>
<a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a><span class="w">      </span><span class="nt">hub</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">               </span><span class="c1"># Subscription hub URL</span>
<a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a><span class="w">      </span><span class="nt">topic</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">             </span><span class="c1"># Topic to subscribe to</span>
<a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a><span class="w">      </span><span class="nt">callback</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">          </span><span class="c1"># Callback URL for receiving events (optional, for dynamic registration)</span>
<a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a><span class="w">      </span><span class="nt">secret</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">            </span><span class="c1"># Secret for verifying webhook payloads (optional)</span>
<a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a><span class="w">      </span><span class="nt">authentication</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span><span class="w">    </span><span class="c1"># Authentication configuration for the subscription  (optional)</span>
</code></pre></div>
<h4 id="533-field-definitions">5.3.3. Field Definitions<a class="headerlink" href="#533-field-definitions" title="Permanent link">&para;</a></h4>
<p>The <code>interfaces</code> field is an array where each element represents an interface definition.</p>
<p><strong>Interface Object:</strong></p>
<p>The interface object <strong>MUST</strong> be one of the following variants, discriminated by the <code>type</code> field.</p>
<p><strong>Consolechat Interface:</strong></p>
<p>Command-line/terminal chat interface for interactive console-based conversations.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Must be <code>"consolechat"</code>.</td>
</tr>
<tr>
<td><code>signature</code></td>
<td><code>object</code></td>
<td>No</td>
<td>Defines the agent's input and output parameters. Defaults to string input and string output. See <a href="#signature-object">Signature Object</a>.</td>
</tr>
</tbody>
</table>
<p><strong>Webchat Interface:</strong></p>
<p>Web-based chat interface accessible through browsers with a conversational UI.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Must be <code>"webchat"</code>.</td>
</tr>
<tr>
<td><code>signature</code></td>
<td><code>object</code></td>
<td>No</td>
<td>Defines the agent's input and output parameters. Defaults to string input and string output. See <a href="#signature-object">Signature Object</a>.</td>
</tr>
<tr>
<td><code>exposure</code></td>
<td><code>object</code></td>
<td>No</td>
<td>Configuration for how the agent is exposed via HTTP. See <a href="#exposure-object">Exposure Object</a>.</td>
</tr>
</tbody>
</table>
<p><strong>Webhook Interface:</strong></p>
<p>Webhook endpoint with subscription support.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Must be <code>"webhook"</code>.</td>
</tr>
<tr>
<td><code>prompt</code></td>
<td><code>string</code></td>
<td>No</td>
<td>A template string for constructing the user prompt for an agent run from webhook data.<br>Supports <a href="#7-variable-substitution">variable substitution</a> with HTTP context prefixes:<br>- <code>${http:payload.fieldname}</code> to access webhook payload fields<br>- <code>${http:header.headername}</code> to access HTTP headers<br>When provided, this templated prompt is used as the user prompt to the agent.<br>When omitted, the implementation determines how to construct the agent prompt from the webhook payload.</td>
</tr>
<tr>
<td><code>signature</code></td>
<td><code>object</code></td>
<td>No</td>
<td>Defines the agent's output parameters. The <code>input</code> field MAY be omitted as the webhook provider determines the input payload structure. See <a href="#signature-object">Signature Object</a>.</td>
</tr>
<tr>
<td><code>exposure</code></td>
<td><code>object</code></td>
<td>No</td>
<td>Configuration for how the agent is exposed via HTTP. See <a href="#exposure-object">Exposure Object</a>.</td>
</tr>
<tr>
<td><code>subscription</code></td>
<td><code>object</code></td>
<td>No</td>
<td>Subscription configuration. See <a href="#subscription-object">Subscription Object</a>.</td>
</tr>
</tbody>
</table>
<h5 id="signature-object">Signature Object<a class="headerlink" href="#signature-object" title="Permanent link">&para;</a></h5>
<p>Defines the data contract for the agent. The <code>input</code> and <code>output</code> fields MUST conform to the <a href="https://json-schema.org/">JSON Schema</a> specification, but are expressed in YAML syntax. This allows for:</p>
<ul>
<li>Simple signatures (e.g., a single string, number, boolean, or array)</li>
<li>Complex, structured objects with named properties</li>
<li>Full expressiveness of JSON Schema for validation and documentation</li>
</ul>
<p><strong>Examples:</strong></p>
<p><em>Single string input/output (default):</em></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="nt">signature</span><span class="p">:</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="w">  </span><span class="nt">input</span><span class="p">:</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="w">  </span><span class="nt">output</span><span class="p">:</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
</code></pre></div>
<p><em>Complex object with properties:</em></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="nt">signature</span><span class="p">:</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a><span class="w">  </span><span class="nt">input</span><span class="p">:</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a><span class="w">    </span><span class="nt">properties</span><span class="p">:</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a><span class="w">      </span><span class="nt">user_prompt</span><span class="p">:</span>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;The</span><span class="nv"> </span><span class="s">user&#39;s</span><span class="nv"> </span><span class="s">query</span><span class="nv"> </span><span class="s">or</span><span class="nv"> </span><span class="s">request&quot;</span>
<a id="__codelineno-7-8" name="__codelineno-7-8" href="#__codelineno-7-8"></a><span class="w">      </span><span class="nt">context</span><span class="p">:</span>
<a id="__codelineno-7-9" name="__codelineno-7-9" href="#__codelineno-7-9"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<a id="__codelineno-7-10" name="__codelineno-7-10" href="#__codelineno-7-10"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Additional</span><span class="nv"> </span><span class="s">context</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">request&quot;</span>
<a id="__codelineno-7-11" name="__codelineno-7-11" href="#__codelineno-7-11"></a><span class="w">    </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">user_prompt</span><span class="p p-Indicator">]</span>
<a id="__codelineno-7-12" name="__codelineno-7-12" href="#__codelineno-7-12"></a><span class="w">  </span><span class="nt">output</span><span class="p">:</span>
<a id="__codelineno-7-13" name="__codelineno-7-13" href="#__codelineno-7-13"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<a id="__codelineno-7-14" name="__codelineno-7-14" href="#__codelineno-7-14"></a><span class="w">    </span><span class="nt">properties</span><span class="p">:</span>
<a id="__codelineno-7-15" name="__codelineno-7-15" href="#__codelineno-7-15"></a><span class="w">      </span><span class="nt">response</span><span class="p">:</span>
<a id="__codelineno-7-16" name="__codelineno-7-16" href="#__codelineno-7-16"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-7-17" name="__codelineno-7-17" href="#__codelineno-7-17"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;The</span><span class="nv"> </span><span class="s">agent&#39;s</span><span class="nv"> </span><span class="s">response</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">user</span><span class="nv"> </span><span class="s">prompt&quot;</span>
<a id="__codelineno-7-18" name="__codelineno-7-18" href="#__codelineno-7-18"></a><span class="w">      </span><span class="nt">confidence</span><span class="p">:</span>
<a id="__codelineno-7-19" name="__codelineno-7-19" href="#__codelineno-7-19"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">number</span>
<a id="__codelineno-7-20" name="__codelineno-7-20" href="#__codelineno-7-20"></a><span class="w">        </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Confidence</span><span class="nv"> </span><span class="s">score</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">response&quot;</span>
<a id="__codelineno-7-21" name="__codelineno-7-21" href="#__codelineno-7-21"></a><span class="w">    </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">response</span><span class="p p-Indicator">]</span>
</code></pre></div>
<p><em>Array input/output:</em>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="nt">signature</span><span class="p">:</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a><span class="w">  </span><span class="nt">input</span><span class="p">:</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">array</span>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="w">    </span><span class="nt">items</span><span class="p">:</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a><span class="w">  </span><span class="nt">output</span><span class="p">:</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">array</span>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="w">    </span><span class="nt">items</span><span class="p">:</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
</code></pre></div></p>
<p><strong>Default Behavior:</strong></p>
<p>Default signature behavior:</p>
<ul>
<li>
<p>For <code>consolechat</code> and <code>webchat</code> types: the default <code>signature</code> is string input and string output.</p>
</li>
<li>
<p>For <code>webhook</code> type: the <code>input</code> field MAY be omitted, as the webhook provider determines the input payload structure.</p>
</li>
</ul>
<p>AFM implementations <strong>SHALL</strong> use this definition to generate the agent's callable interface and to ensure consistent behavior across different platforms.</p>
<p><a id="subscription-object"></a>
<strong>Subscription Object:</strong></p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>protocol</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>The subscription protocol (e.g., <code>websub</code>).</td>
</tr>
<tr>
<td><code>hub</code></td>
<td><code>string</code></td>
<td>No</td>
<td>The hub to subscribe at (optional if subscription is registered manually).</td>
</tr>
<tr>
<td><code>topic</code></td>
<td><code>string</code></td>
<td>No</td>
<td>The topic to subscribe to (optional if subscription is registered manually).</td>
</tr>
<tr>
<td><code>callback</code></td>
<td><code>string</code></td>
<td>No</td>
<td>The callback URL where events should be delivered (optional, for dynamic or self-registration).</td>
</tr>
<tr>
<td><code>authentication</code></td>
<td><code>object</code></td>
<td>No</td>
<td>Optional authentication configuration for the webhook subscription. See <a href="#56-authentication">Section 5.6</a> for the schema.</td>
</tr>
<tr>
<td><code>secret</code></td>
<td><code>string</code></td>
<td>No</td>
<td>A secret used to sign or verify webhook payloads (optional, for security).</td>
</tr>
</tbody>
</table>
<h5 id="exposure-object">Exposure Object<a class="headerlink" href="#exposure-object" title="Permanent link">&para;</a></h5>
<p>Applies to agents of type <code>webchat</code> and <code>webhook</code>, and defines how the corresponding services are exposed.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>http</code></td>
<td><code>object</code></td>
<td>No</td>
<td>Defines how to expose the agent via a standard HTTP endpoint.</td>
</tr>
</tbody>
</table>
<p><strong>HTTP Object:</strong></p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>path</code></td>
<td><code>string</code></td>
<td>No</td>
<td>The URL path segment for the agent's HTTP endpoint (e.g., <code>/math-tutor</code>). If not specified, implementations <strong>SHOULD</strong> use <code>/chat</code> for <code>webchat</code> interfaces and <code>/webhook</code> for <code>webhook</code> interfaces.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">HTTP Exposure Configuration</p>
<p>The <code>http</code> object is applicable for agents of type <code>webchat</code> or <code>webhook</code>. It defines how the agent is exposed via a standard HTTP endpoint, allowing other systems to interact with it over the web.</p>
<p><strong>Default Paths:</strong></p>
<ul>
<li><code>webchat</code>: If no <code>exposure.http.path</code> is specified, implementations <strong>SHOULD</strong> default to <code>/chat</code></li>
<li><code>webhook</code>: If no <code>exposure.http.path</code> is specified, implementations <strong>SHOULD</strong> default to <code>/webhook</code></li>
</ul>
<p>AFM does not define the HTTP methods (GET, POST, etc.) for the agent's endpoint. This is left to the implementation to decide based on the agent's functionality and requirements.</p>
</div>
<h4 id="534-example-usages">5.3.4. Example Usages<a class="headerlink" href="#534-example-usages" title="Permanent link">&para;</a></h4>
<p><strong>Web chat agent (default simple string):</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="nt">interfaces</span><span class="p">:</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">webchat</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">    </span><span class="nt">signature</span><span class="p">:</span>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">      </span><span class="nt">input</span><span class="p">:</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">      </span><span class="nt">output</span><span class="p">:</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
</code></pre></div></p>
<p><strong>Web chat agent (custom with structured input/output):</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="nt">interfaces</span><span class="p">:</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">webchat</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">    </span><span class="nt">signature</span><span class="p">:</span>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">      </span><span class="nt">input</span><span class="p">:</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">        </span><span class="nt">properties</span><span class="p">:</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="w">          </span><span class="nt">message</span><span class="p">:</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a><span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;The</span><span class="nv"> </span><span class="s">user&#39;s</span><span class="nv"> </span><span class="s">chat</span><span class="nv"> </span><span class="s">message&quot;</span>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="w">          </span><span class="nt">context</span><span class="p">:</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a><span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Additional</span><span class="nv"> </span><span class="s">context</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">conversation&quot;</span>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="w">        </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">message</span><span class="p p-Indicator">]</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="w">      </span><span class="nt">output</span><span class="p">:</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="w">        </span><span class="nt">properties</span><span class="p">:</span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="w">          </span><span class="nt">reply</span><span class="p">:</span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;The</span><span class="nv"> </span><span class="s">agent&#39;s</span><span class="nv"> </span><span class="s">chat</span><span class="nv"> </span><span class="s">reply&quot;</span>
<a id="__codelineno-10-20" name="__codelineno-10-20" href="#__codelineno-10-20"></a><span class="w">          </span><span class="nt">confidence</span><span class="p">:</span>
<a id="__codelineno-10-21" name="__codelineno-10-21" href="#__codelineno-10-21"></a><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">number</span>
<a id="__codelineno-10-22" name="__codelineno-10-22" href="#__codelineno-10-22"></a><span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Confidence</span><span class="nv"> </span><span class="s">score</span><span class="nv"> </span><span class="s">for</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">response&quot;</span>
<a id="__codelineno-10-23" name="__codelineno-10-23" href="#__codelineno-10-23"></a><span class="w">        </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">reply</span><span class="p p-Indicator">]</span>
<a id="__codelineno-10-24" name="__codelineno-10-24" href="#__codelineno-10-24"></a><span class="w">    </span><span class="nt">exposure</span><span class="p">:</span>
<a id="__codelineno-10-25" name="__codelineno-10-25" href="#__codelineno-10-25"></a><span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<a id="__codelineno-10-26" name="__codelineno-10-26" href="#__codelineno-10-26"></a><span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/webchat&quot;</span>
</code></pre></div></p>
<p><strong>Console chat agent:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="nt">interfaces</span><span class="p">:</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">consolechat</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">    </span><span class="nt">signature</span><span class="p">:</span>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">      </span><span class="nt">input</span><span class="p">:</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">      </span><span class="nt">output</span><span class="p">:</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
</code></pre></div></p>
<p><strong>Webhook agent (with prompt templating):</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="nt">interfaces</span><span class="p">:</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">webhook</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">    </span><span class="nt">prompt</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">      </span><span class="no">A new ${http:payload.event} event was received from ${http:header.User-Agent}.</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">      </span><span class="no">Event Details:</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="w">      </span><span class="no">- Type: ${http:payload.event}</span>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="w">      </span><span class="no">- Timestamp: ${http:payload.timestamp}</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="w">      </span><span class="no">- Source: ${http:payload.source}</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="w">      </span><span class="no">Payload:</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="w">      </span><span class="no">${http:payload.data}</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="w">      </span><span class="no">Please analyze this webhook event and provide a summary of the action taken.</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a><span class="w">    </span><span class="nt">signature</span><span class="p">:</span>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="w">      </span><span class="nt">output</span><span class="p">:</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">object</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a><span class="w">        </span><span class="nt">properties</span><span class="p">:</span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a><span class="w">          </span><span class="nt">result</span><span class="p">:</span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="w">            </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a><span class="w">            </span><span class="nt">description</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;The</span><span class="nv"> </span><span class="s">agent&#39;s</span><span class="nv"> </span><span class="s">response</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">webhook</span><span class="nv"> </span><span class="s">event&quot;</span>
<a id="__codelineno-12-22" name="__codelineno-12-22" href="#__codelineno-12-22"></a><span class="w">        </span><span class="nt">required</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">result</span><span class="p p-Indicator">]</span>
<a id="__codelineno-12-23" name="__codelineno-12-23" href="#__codelineno-12-23"></a><span class="w">    </span><span class="nt">subscription</span><span class="p">:</span>
<a id="__codelineno-12-24" name="__codelineno-12-24" href="#__codelineno-12-24"></a><span class="w">      </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;websub&quot;</span>
<a id="__codelineno-12-25" name="__codelineno-12-25" href="#__codelineno-12-25"></a><span class="w">      </span><span class="nt">hub</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/websub-hub&quot;</span>
<a id="__codelineno-12-26" name="__codelineno-12-26" href="#__codelineno-12-26"></a><span class="w">      </span><span class="nt">topic</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/events/agent&quot;</span>
<a id="__codelineno-12-27" name="__codelineno-12-27" href="#__codelineno-12-27"></a><span class="w">      </span><span class="nt">callback</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://myagent.example.com/webhook-callback&quot;</span>
<a id="__codelineno-12-28" name="__codelineno-12-28" href="#__codelineno-12-28"></a><span class="w">      </span><span class="nt">secret</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${env:WEBHOOK_SECRET}&quot;</span>
<a id="__codelineno-12-29" name="__codelineno-12-29" href="#__codelineno-12-29"></a><span class="w">    </span><span class="nt">exposure</span><span class="p">:</span>
<a id="__codelineno-12-30" name="__codelineno-12-30" href="#__codelineno-12-30"></a><span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<a id="__codelineno-12-31" name="__codelineno-12-31" href="#__codelineno-12-31"></a><span class="w">        </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/webhook-handler&quot;</span>
</code></pre></div></p>
<h3 id="54-tools">5.4. Tools<a class="headerlink" href="#54-tools" title="Permanent link">&para;</a></h3>
<p>This section defines the tools the agent can access and use.</p>
<h4 id="541-schema-overview">5.4.1. Schema Overview<a class="headerlink" href="#541-schema-overview" title="Permanent link">&para;</a></h4>
<p>The tools fields are specified in the YAML front matter of an AFM file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="nt">tools</span><span class="p">:</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">  </span><span class="nt">mcp</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">array</span><span class="w">         </span><span class="c1"># List of MCP servers to connect to.</span>
</code></pre></div>
<h4 id="542-field-definitions">5.4.2. Field Definitions<a class="headerlink" href="#542-field-definitions" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>tools</code></td>
<td><code>object</code></td>
<td>No</td>
<td>Container for protocol-specific tool connection configurations.</td>
</tr>
<tr>
<td><code>tools.mcp</code></td>
<td><code>array</code></td>
<td>No</td>
<td>List of MCP servers to connect to. See <a href="#61-model-context-protocol-mcp">Section 6.1</a> for detailed schema.</td>
</tr>
</tbody>
</table>
<h4 id="543-example-usage">5.4.3. Example Usage<a class="headerlink" href="#543-example-usage" title="Permanent link">&para;</a></h4>
<p>Here's a simple example of tools in an AFM file:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="nt">tools</span><span class="p">:</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">  </span><span class="nt">mcp</span><span class="p">:</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;github_api&quot;</span>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">      </span><span class="nt">transport</span><span class="p">:</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http&quot;</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">        </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://api.githubcopilot.com/mcp/&quot;</span>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">        </span><span class="nt">authentication</span><span class="p">:</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bearer&quot;</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">          </span><span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${env:GITHUB_TOKEN}&quot;</span>
</code></pre></div>
<h3 id="55-agent-execution">5.5. Agent Execution<a class="headerlink" href="#55-agent-execution" title="Permanent link">&para;</a></h3>
<p>This section defines execution control and runtime behavior settings for the agent. These settings are <strong>OPTIONAL</strong> and help AFM implementations manage agent execution safely and efficiently.</p>
<h4 id="551-schema-overview">5.5.1. Schema Overview<a class="headerlink" href="#551-schema-overview" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="nt">max_iterations</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">int</span><span class="w">    </span><span class="c1"># Maximum number of iterations per agent run</span>
</code></pre></div>
<h4 id="552-field-definitions">5.5.2. Field Definitions<a class="headerlink" href="#552-field-definitions" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>max_iterations</code></td>
<td><code>integer</code></td>
<td>No</td>
<td>Maximum number of iterations the agent can perform in a single run.<br>This helps prevent infinite loops or runaway execution.<br>Default: Implementation-specific (typically unlimited or a high value like 100).<br>AFM implementations <strong>SHOULD</strong> respect this limit and gracefully terminate agent execution when the limit is reached.</td>
</tr>
</tbody>
</table>
<h4 id="553-example-usage">5.5.3. Example Usage<a class="headerlink" href="#553-example-usage" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="nt">max_iterations</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">50</span>
</code></pre></div>
<h3 id="56-authentication">5.6. Authentication<a class="headerlink" href="#56-authentication" title="Permanent link">&para;</a></h3>
<p>This section defines the generic client authentication schema that is used across different parts of the AFM specification, including MCP server connections and webhook subscriptions.</p>
<p>The authentication object is <strong>OPTIONAL</strong>.</p>
<h4 id="561-schema-overview">5.6.1. Schema Overview<a class="headerlink" href="#561-schema-overview" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="nt">authentication</span><span class="p">:</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">         </span><span class="c1"># Authentication scheme (bearer, jwt, oauth2, api-key, basic, etc.)</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="w">  </span><span class="c1"># Additional fields depend on the type</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="w">  </span><span class="c1"># Examples:</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">  </span><span class="c1"># - For bearer: token</span>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="w">  </span><span class="c1"># - For basic: username, password</span>
</code></pre></div>
<h4 id="562-field-definitions">5.6.2. Field Definitions<a class="headerlink" href="#562-field-definitions" title="Permanent link">&para;</a></h4>
<p><a id="authentication-object"></a><strong>Authentication Object:</strong></p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Authentication scheme (e.g., <code>bearer</code>, <code>basic</code>, <code>jwt</code>, <code>oauth2</code>).<br>Determines which additional fields are required or supported.</td>
</tr>
<tr>
<td><code>*</code></td>
<td>Various</td>
<td>Varies</td>
<td>Additional fields are authentication-type specific. See examples below for common patterns.<br>Values <strong>SHOULD</strong> use <a href="#7-variable-substitution">variable substitution</a> to reference credentials securely.</td>
</tr>
</tbody>
</table>
<!-- !!! note "Authentication Field Structure"
    The authentication object uses a type-specific structure where the `type` field determines which additional fields are needed:

    - **bearer**: Requires `token` field
    - **basic**: Requires `username` and `password` fields
    - **oauth2**: May require a `grant_type` field and fields like `client_id`, `client_secret`, `token_url`, `scope`, etc.

    The exact set of fields and their semantics are implementation-specific, but implementations **SHOULD** follow common authentication patterns for each type. -->

<!-- !!! warning "Security Best Practices"
    Sensitive credentials (e.g., tokens, passwords, secrets, keys) **SHOULD NOT** be hardcoded in AFM files. Instead:

    - Use [variable substitution](#7-variable-substitution) to reference credentials from secure sources
    - Let the agent's host environment manage actual credential storage and retrieval -->

<h4 id="563-example-usage">5.6.3. Example Usage<a class="headerlink" href="#563-example-usage" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="c1"># Bearer token authentication</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="nt">authentication</span><span class="p">:</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bearer</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">  </span><span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${env:API_TOKEN}&quot;</span>
<a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a>
<a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="c1"># Basic authentication</span>
<a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="nt">authentication</span><span class="p">:</span>
<a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">basic</span>
<a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="w">  </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${env:API_USERNAME}&quot;</span>
<a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="w">  </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${env:API_PASSWORD}&quot;</span>
</code></pre></div>
<h2 id="6-protocol-specifications">6. Protocol Specifications<a class="headerlink" href="#6-protocol-specifications" title="Permanent link">&para;</a></h2>
<p>This section details the protocols that agents use to communicate with external systems and other agents, as referenced in the schema above.</p>
<h3 id="61-model-context-protocol-mcp">6.1. Model Context Protocol (MCP)<a class="headerlink" href="#61-model-context-protocol-mcp" title="Permanent link">&para;</a></h3>
<p>The Model Context Protocol (MCP) enables agents to connect to external tools and data sources.</p>
<h4 id="611-schema-overview">6.1.1. Schema Overview<a class="headerlink" href="#611-schema-overview" title="Permanent link">&para;</a></h4>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="nt">mcp</span><span class="p">:</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">            </span><span class="c1"># Unique identifier for the server connection</span>
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">    </span><span class="nt">transport</span><span class="p">:</span>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">      </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">          </span><span class="c1"># Transport mechanism (&quot;http&quot; or &quot;stdio&quot;)</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="w">      </span><span class="c1"># For HTTP transport:</span>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">      </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">           </span><span class="c1"># URL for the MCP server</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">      </span><span class="nt">authentication</span><span class="p">:</span><span class="w">       </span><span class="c1"># Optional authentication configuration</span>
<a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">        </span><span class="c1"># Authentication scheme (bearer, jwt, oauth2, etc.)</span>
<a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a>
<a id="__codelineno-19-11" name="__codelineno-19-11" href="#__codelineno-19-11"></a><span class="w">      </span><span class="c1"># For STDIO transport:</span>
<a id="__codelineno-19-12" name="__codelineno-19-12" href="#__codelineno-19-12"></a><span class="w">      </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">string</span><span class="w">       </span><span class="c1"># Executable command to run</span>
<a id="__codelineno-19-13" name="__codelineno-19-13" href="#__codelineno-19-13"></a><span class="w">      </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">string</span><span class="p p-Indicator">]</span><span class="w">        </span><span class="c1"># Optional arguments for the command</span>
<a id="__codelineno-19-14" name="__codelineno-19-14" href="#__codelineno-19-14"></a><span class="w">      </span><span class="nt">env</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">{</span><span class="nt">string</span><span class="p">:</span><span class="w"> </span><span class="nv">string</span><span class="p p-Indicator">}</span><span class="w"> </span><span class="c1"># Optional environment variables</span>
<a id="__codelineno-19-15" name="__codelineno-19-15" href="#__codelineno-19-15"></a>
<a id="__codelineno-19-16" name="__codelineno-19-16" href="#__codelineno-19-16"></a><span class="w">    </span><span class="nt">tool_filter</span><span class="p">:</span><span class="w">            </span><span class="c1"># Optional</span>
<a id="__codelineno-19-17" name="__codelineno-19-17" href="#__codelineno-19-17"></a><span class="w">      </span><span class="nt">allow</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">string</span><span class="p p-Indicator">]</span><span class="w">       </span><span class="c1"># Whitelist of tools</span>
<a id="__codelineno-19-18" name="__codelineno-19-18" href="#__codelineno-19-18"></a><span class="w">      </span><span class="nt">deny</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">string</span><span class="p p-Indicator">]</span><span class="w">        </span><span class="c1"># Blacklist of tools</span>
</code></pre></div>
<h4 id="612-field-definitions">6.1.2. Field Definitions<a class="headerlink" href="#612-field-definitions" title="Permanent link">&para;</a></h4>
<p>The <code>mcp</code> field is an array where each element represents an MCP server connection. Each server entry must have a unique <code>name</code> that identifies the connection.</p>
<p><strong>MCP Server Object:</strong></p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>name</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>A unique, human-readable identifier for the connection.</td>
</tr>
<tr>
<td><code>transport</code></td>
<td><code>object</code></td>
<td>Yes</td>
<td>An object defining the transport mechanism. See <a href="#transport-object">Transport Object</a> below.</td>
</tr>
<tr>
<td><code>tool_filter</code></td>
<td><code>object</code></td>
<td>No</td>
<td>Filter configuration for tools from this server. See <a href="#tool-filter-object">Tool Filter Object</a> below.</td>
</tr>
</tbody>
</table>
<p><strong><a id="transport-object"></a>Transport Object:</strong></p>
<p>The transport object <strong>MUST</strong> be one of the following variants, discriminated by the <code>type</code> field.</p>
<p><strong>HTTP Transport:</strong></p>
<p>Used for connecting to remote MCP servers over HTTP.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Must be <code>"http"</code>.</td>
</tr>
<tr>
<td><code>url</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>The URL of the MCP server.</td>
</tr>
<tr>
<td><code>authentication</code></td>
<td><code>object</code></td>
<td>No</td>
<td>Authentication configuration. See <a href="#56-authentication">Section 5.6</a> for the schema.</td>
</tr>
</tbody>
</table>
<p><strong>STDIO Transport:</strong></p>
<p>Used for running local MCP servers as subprocesses via standard input/output.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>type</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>Must be <code>"stdio"</code>.</td>
</tr>
<tr>
<td><code>command</code></td>
<td><code>string</code></td>
<td>Yes</td>
<td>The executable command to run (e.g., <code>python</code>, <code>node</code>, <code>npx</code>).</td>
</tr>
<tr>
<td><code>args</code></td>
<td><code>string[]</code></td>
<td>No</td>
<td>An array of arguments to pass to the command.</td>
</tr>
<tr>
<td><code>env</code></td>
<td><code>map&lt;string, string&gt;</code></td>
<td>No</td>
<td>A key-value map of environment variables to set for the process. Values MAY use <a href="#7-variable-substitution">variable substitution</a>.</td>
</tr>
</tbody>
</table>
<p><strong><a id="tool-filter-object"></a>Tool Filter Object:</strong></p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Required</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>allow</code></td>
<td><code>string[]</code></td>
<td>No</td>
<td>A whitelist of tools to expose from this server, using just the tool name (e.g., <code>create_issue</code>, <code>read_file</code>). If specified, only these tools are available.</td>
</tr>
<tr>
<td><code>deny</code></td>
<td><code>string[]</code></td>
<td>No</td>
<td>A blacklist of tools to hide from this server, using just the tool name (e.g., <code>write_file</code>). Applied after <code>allow</code> filtering.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Filter Precedence</p>
<p>When both <code>allow</code> and <code>deny</code> are specified, the tools in the <code>allow</code> list are made available and then the <code>deny</code> list is applied to remove specific tools from that filtered set. If only <code>deny</code> is specified, all tools from the server are available except those in the deny list.</p>
</div>
<h4 id="613-example-usage">6.1.3. Example Usage<a class="headerlink" href="#613-example-usage" title="Permanent link">&para;</a></h4>
<p><strong>HTTP Transport Examples:</strong></p>
<p>These examples define tool connections to remote MCP servers, using the streamable HTTP transport, with authentication and tool filtering. Note the use of <a href="#7-variable-substitution">variable substitution</a> for sensitive and/or variable input.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="nt">tools</span><span class="p">:</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">  </span><span class="nt">mcp</span><span class="p">:</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;github_mcp_server&quot;</span>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">      </span><span class="nt">transport</span><span class="p">:</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http&quot;</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">        </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${env:GITHUB_MCP_URL}&quot;</span>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">        </span><span class="nt">authentication</span><span class="p">:</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bearer&quot;</span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="w">          </span><span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${env:GITHUB_OAUTH_TOKEN}&quot;</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="w">      </span><span class="nt">tool_filter</span><span class="p">:</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="w">        </span><span class="nt">allow</span><span class="p">:</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;issues.create&quot;</span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;repos.list&quot;</span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;database_server&quot;</span>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="w">      </span><span class="nt">transport</span><span class="p">:</span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http&quot;</span>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a><span class="w">        </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${env:DATABASE_MCP_URL}&quot;</span>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a><span class="w">        </span><span class="nt">authentication</span><span class="p">:</span>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a><span class="w">          </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bearer&quot;</span>
<a id="__codelineno-20-21" name="__codelineno-20-21" href="#__codelineno-20-21"></a><span class="w">          </span><span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${env:DATABASE_API_KEY}&quot;</span>
<a id="__codelineno-20-22" name="__codelineno-20-22" href="#__codelineno-20-22"></a><span class="w">      </span><span class="nt">tool_filter</span><span class="p">:</span>
<a id="__codelineno-20-23" name="__codelineno-20-23" href="#__codelineno-20-23"></a><span class="w">        </span><span class="nt">allow</span><span class="p">:</span>
<a id="__codelineno-20-24" name="__codelineno-20-24" href="#__codelineno-20-24"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;query&quot;</span>
<a id="__codelineno-20-25" name="__codelineno-20-25" href="#__codelineno-20-25"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;search&quot;</span>
<a id="__codelineno-20-26" name="__codelineno-20-26" href="#__codelineno-20-26"></a><span class="w">        </span><span class="nt">deny</span><span class="p">:</span>
<a id="__codelineno-20-27" name="__codelineno-20-27" href="#__codelineno-20-27"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;delete&quot;</span>
<a id="__codelineno-20-28" name="__codelineno-20-28" href="#__codelineno-20-28"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;drop_table&quot;</span>
</code></pre></div>
<p><strong>STDIO Transport Examples:</strong></p>
<p>These examples demonstrate MCP tools over the STDIO transport.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="nt">tools</span><span class="p">:</span>
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">  </span><span class="nt">mcp</span><span class="p">:</span>
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="w">    </span><span class="c1"># Node.js MCP server via NPX</span>
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;filesystem_server&quot;</span>
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">      </span><span class="nt">transport</span><span class="p">:</span>
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;stdio&quot;</span>
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="w">        </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;npx&quot;</span>
<a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="w">        </span><span class="nt">args</span><span class="p">:</span>
<a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;-y&quot;</span>
<a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;@modelcontextprotocol/server-filesystem&quot;</span>
<a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;/path/to/desktop&quot;</span>
<a id="__codelineno-21-12" name="__codelineno-21-12" href="#__codelineno-21-12"></a>
<a id="__codelineno-21-13" name="__codelineno-21-13" href="#__codelineno-21-13"></a><span class="w">    </span><span class="c1"># Local Python MCP server with environment variables</span>
<a id="__codelineno-21-14" name="__codelineno-21-14" href="#__codelineno-21-14"></a><span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;local_database_tool&quot;</span>
<a id="__codelineno-21-15" name="__codelineno-21-15" href="#__codelineno-21-15"></a><span class="w">      </span><span class="nt">transport</span><span class="p">:</span>
<a id="__codelineno-21-16" name="__codelineno-21-16" href="#__codelineno-21-16"></a><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;stdio&quot;</span>
<a id="__codelineno-21-17" name="__codelineno-21-17" href="#__codelineno-21-17"></a><span class="w">        </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;python&quot;</span>
<a id="__codelineno-21-18" name="__codelineno-21-18" href="#__codelineno-21-18"></a><span class="w">        </span><span class="nt">args</span><span class="p">:</span>
<a id="__codelineno-21-19" name="__codelineno-21-19" href="#__codelineno-21-19"></a><span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;server.py&quot;</span>
<a id="__codelineno-21-20" name="__codelineno-21-20" href="#__codelineno-21-20"></a><span class="w">        </span><span class="nt">env</span><span class="p">:</span>
<a id="__codelineno-21-21" name="__codelineno-21-21" href="#__codelineno-21-21"></a><span class="w">          </span><span class="nt">DB_PATH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;./data.db&quot;</span>
<a id="__codelineno-21-22" name="__codelineno-21-22" href="#__codelineno-21-22"></a><span class="w">          </span><span class="nt">API_KEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${env:LOCAL_DB_API_KEY}&quot;</span>
</code></pre></div>
<h2 id="7-variable-substitution">7. Variable Substitution<a class="headerlink" href="#7-variable-substitution" title="Permanent link">&para;</a></h2>
<p>AFM files MAY use <code>${...}</code> syntax for variable substitution.</p>
<p>This specification defines three standard variable prefixes:</p>
<ul>
<li>The <code>env:</code> prefix (e.g., <code>${env:API_TOKEN}</code>) is <strong>specification-defined</strong> and MUST resolve to an environment variable, generally at agent load time (i.e., variable resolution for <code>env:</code> occurs before the agent is made available for use).</li>
<li>The <code>http:payload</code> prefix (e.g., <code>${http:payload.field}</code>) is <strong>specification-defined</strong> for webhook interfaces and MUST resolve to the corresponding field in the incoming webhook payload at runtime. Variable resolution for <code>http:payload</code> occurs at runtime for each webhook invocation.</li>
<li>The <code>http:header</code> prefix (e.g., <code>${http:header.User-Agent}</code>) is <strong>specification-defined</strong> for webhook interfaces and MUST resolve to the corresponding HTTP header value from the incoming webhook request at runtime. Header names are case-insensitive.</li>
</ul>
<p>Implementations MAY define and support additional variable substitution conventions beyond those specified here. Common examples include <code>file:</code> and <code>secret:</code>, but these are <strong>implementation-defined</strong> and MAY vary between AFM implementations. The timing and semantics of resolution for these prefixes are determined by the implementation.</p>
<h3 id="71-variable-prefixes">7.1. Variable Prefixes<a class="headerlink" href="#71-variable-prefixes" title="Permanent link">&para;</a></h3>
<p>The following table summarizes variable prefixes and their status:</p>
<table>
<thead>
<tr>
<th>Prefix</th>
<th>Context</th>
<th>Description</th>
<th>Example</th>
<th>Spec Status</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>env:</code></td>
<td>Static</td>
<td>Environment variable</td>
<td><code>${env:API_TOKEN}</code></td>
<td><strong>Spec-defined</strong></td>
</tr>
<tr>
<td><code>http:payload</code></td>
<td>Runtime (webhook)</td>
<td>Access webhook payload fields</td>
<td><code>${http:payload.event}</code> or <code>${http:payload['nested.field']}</code></td>
<td><strong>Spec-defined</strong></td>
</tr>
<tr>
<td><code>http:header</code></td>
<td>Runtime (webhook)</td>
<td>Access HTTP request headers</td>
<td><code>${http:header.User-Agent}</code> or <code>${http:header.X-GitHub-Event}</code></td>
<td><strong>Spec-defined</strong></td>
</tr>
<tr>
<td><code>file:</code></td>
<td>Static</td>
<td>Value from external config file</td>
<td><code>${file:api.baseUrl}</code></td>
<td>Implementation-defined</td>
</tr>
<tr>
<td><code>secret:</code></td>
<td>Static</td>
<td>Value from secrets manager</td>
<td><code>${secret:MODEL_API_KEY}</code></td>
<td>Implementation-defined</td>
</tr>
</tbody>
</table>
<p><strong>Static vs Runtime Resolution:</strong></p>
<ul>
<li><strong>Static variables</strong> (<code>env:</code>, <code>file:</code>, <code>secret:</code>): Resolved once when the agent is loaded or initialized</li>
<li><strong>Runtime variables</strong> (<code>http:payload</code>, <code>http:header</code>): Resolved dynamically for each webhook invocation using request-specific data</li>
</ul>
<h3 id="72-example-usage">7.2. Example Usage<a class="headerlink" href="#72-example-usage" title="Permanent link">&para;</a></h3>
<p><strong>Static variable substitution:</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="nt">authentication</span><span class="p">:</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bearer&quot;</span>
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w">  </span><span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${env:API_TOKEN}&quot;</span><span class="w">        </span><span class="c1"># Environment variable</span>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="nt">transport</span><span class="p">:</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="w">  </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${file:api.baseUrl}&quot;</span><span class="w">        </span><span class="c1"># From external config file</span>
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="nt">model</span><span class="p">:</span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="w">  </span><span class="nt">authentication</span><span class="p">:</span>
<a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bearer&quot;</span>
<a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="w">    </span><span class="nt">token</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;${secret:MODEL_API_KEY}&quot;</span><span class="w"> </span><span class="c1"># From secrets manager</span>
</code></pre></div>
<p><strong>Runtime variable substitution (webhook prompts):</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="nt">interfaces</span><span class="p">:</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">webhook</span>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">    </span><span class="nt">prompt</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">      </span><span class="no">New GitHub ${http:payload.action} event on repository ${http:payload.repository.full_name}</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">      </span><span class="no">Event: ${http:header.X-GitHub-Event}</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">      </span><span class="no">Sender: ${http:payload.sender.login}</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>
<a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">      </span><span class="no">Details:</span>
<a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">      </span><span class="no">${http:payload}</span>
</code></pre></div>
<h3 id="73-webhook-variable-access-patterns">7.3. Webhook Variable Access Patterns<a class="headerlink" href="#73-webhook-variable-access-patterns" title="Permanent link">&para;</a></h3>
<p>When using <code>http:payload</code> and <code>http:header</code> in webhook prompts:</p>
<p><strong>Payload Field Access (Specification Requirements):</strong></p>
<ul>
<li>Implementations <strong>MUST</strong> support dot notation for nested object access (e.g., <code>${http:payload.field.nested}</code> resolves to the value of the <code>nested</code> property within the <code>field</code> object).</li>
<li>Implementations <strong>MUST</strong> support bracket notation for field names containing special characters or dots (e.g., <code>${http:payload['field.with.dots']}</code> resolves to the value of the <code>field.with.dots</code> property).</li>
<li>Implementations <strong>MUST</strong> support array access by index (e.g., <code>${http:payload.items[0]}</code> resolves to the first element of the <code>items</code> array).</li>
<li>Implementations <strong>MUST</strong> support combined access for complex paths (e.g., <code>${http:payload.users[0].name}</code> or <code>${http:payload['special-field'][0]}</code> resolves to the <code>name</code> property of the first element in the <code>users</code> array, or the first element of the <code>special-field</code> array, respectively).</li>
<li>Implementations <strong>MUST</strong> support root access, where <code>${http:payload}</code> resolves to the entire payload as a JSON string.</li>
</ul>
<p><strong>Header Access (Specification Requirements):</strong></p>
<ul>
<li>Implementations <strong>MUST</strong> treat header names as case-insensitive (e.g., <code>${http:header.Content-Type}</code> and <code>${http:header.content-type}</code> MUST resolve to the same value).</li>
<li>Implementations <strong>MUST</strong> support access to headers with special characters (e.g., <code>${http:header.X-GitHub-Event}</code> resolves to the value of the <code>X-GitHub-Event</code> header).</li>
</ul>
<p><strong>Error Handling:</strong>
Implementations <strong>SHOULD</strong> handle missing or invalid variable references gracefully by using meaningful defaults or failing with clear error messages.</p>
<h2 id="8-future-work">8. Future Work<a class="headerlink" href="#8-future-work" title="Permanent link">&para;</a></h2>
<p>This section outlines potential future enhancements to the AFM specification, including:</p>
<ul>
<li>Extending tool support to include OpenAPI-based tools for existing services and functions as tools</li>
<li>First-class support for multi-agent interaction via the Agent-to-Agent (A2A) protocol</li>
<li>Support for an Agent memory abstraction covering common memory patterns</li>
<li>Support for Agent Identity</li>
<li>Support for additional interface types (e.g., scheduled execution, REST API)</li>
</ul>







  
  




  



                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <!--
  ~ Copyright (c) 2025, WSO2 LLC (http://www.wso2.com) All Rights Reserved.
  ~
  ~ WSO2 LLC licenses this file to you under the Apache License,
  ~ Version 2.0 (the "License"); you may not use this file except
  ~ in compliance with the License.
  ~ You may obtain a copy of the License at
  ~
  ~     http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~ Unless required by applicable law or agreed to in writing,
  ~ software distributed under the License is distributed on an
  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  ~ KIND, either express or implied. See the License for the
  ~ specific language governing permissions and limitations
  ~ under the License.
  -->

<footer class="md-footer">
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        <div class="md-footer-copyright__content" style="font-size: 0.7rem; line-height: 1.6;">
          <span style="font-weight: 600; font-size: 0.75rem;">Agent-Flavored Markdown - AFM</span><br>
          <span style="font-size: 0.65rem;">Made with <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">Material for MkDocs</a></span>
        </div>
      </div>
      <div class="md-footer-copyright">
        <div class="md-footer-copyright__content" style="text-align: right; font-size: 0.7rem; line-height: 1.6;">
          <span>Copyright  WSO2 LLC (2025 - 2026)</span><br>
          <span style="font-size: 0.65rem; opacity: 0.8;">Licensed under <a href="https://creativecommons.org/licenses/by-nd/4.0/" target="_blank" rel="noopener">CC BY-ND 4.0</a></span>
        </div>
      </div>
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.tabs", "navigation.top", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.tracking", "toc.follow", "search.suggest", "search.highlight", "search.share", "content.code.annotate", "content.code.copy", "content.tabs.link", "content.cards", "announce.dismiss"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../javascripts/extra.js"></script>
      
    
  </body>
</html>